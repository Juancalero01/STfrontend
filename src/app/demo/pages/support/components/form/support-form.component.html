<form class="w-full flex flex-column gap-3 py-2" [formGroup]="supportForm">
  <div class="w-full flex flex-column" *ngIf="showSearch">
    <label>BUSCADOR DEL PRODUCTO</label>
    <div class="w-full flex gap-2">
      <input
        type="text"
        pInputText
        class="w-full"
        formControlName="search"
        [pKeyFilter]="blockSpace"
        maxlength="10"
        [ngClass]="{ 'ng-invalid ng-dirty': validateForm('search') }"
      />
      <p-button
        icon="pi pi-search"
        styleClass=" p-button-secondary"
        (onClick)="searchProduct()"
      />
    </div>
    <small *ngIf="validateForm('search')" class="p-error">
      Campo requerido*
    </small>
  </div>
  <div class="w-full flex gap-2">
    <div class="w-full">
      <label>FECHA DE REGISTRO</label>
      <input
        type="text"
        pInputText
        class="w-full font-bold bg-gray-100"
        formControlName="dateEntry"
      />
    </div>
    <div class="w-full">
      <label>NÚMERO DE RECLAMO</label>
      <input
        type="text"
        pInputText
        class="w-full font-bold bg-gray-100"
        formControlName="reclaim"
      />
    </div>
    <div class="w-full">
      <label>ESTADO DEL SERVICIO</label>
      <p-dropdown
        [options]="supportStatesDropdown"
        optionLabel="name"
        optionValue="id"
        styleClass="w-full font-bold bg-gray-100 uppercase"
        formControlName="state"
        dropdownIcon="none"
      ></p-dropdown>
    </div>
  </div>

  <div class="w-full flex gap-2">
    <div class="w-full">
      <label>TIPO DE PRODUCTO</label>
      <input
        type="text"
        pInputText
        class="w-full font-bold bg-gray-100"
        formControlName="productType"
      />
    </div>
    <div class="w-full">
      <label>CLIENTE</label>
      <input
        type="text"
        pInputText
        class="w-full font-bold bg-gray-100"
        formControlName="client"
      />
    </div>
  </div>

  <div class="w-full flex gap-2">
    <div class="w-full">
      <label>GARANTÍA DE PRODUCCIÓN</label>
      <input
        type="text"
        pInputText
        class="w-full font-bold"
        formControlName="warrantyProduction"
        [class]="
          supportForm.get('warrantyProduction')?.value ===
          'GARANTÍA DE PRODUCCIÓN VENCIDA'
            ? 'bg-red-100 text-red-600'
            : supportForm.get('warrantyProduction')?.value === 'N/A'
            ? 'bg-gray-100 text-gray-600'
            : supportForm.get('warrantyProduction')?.value
            ? 'bg-green-100 text-green-600'
            : 'bg-gray-100 text-gray-600'
        "
      />
    </div>
    <div class="w-full">
      <label>GARANTÍA DE SERVICIO TÉCNICO</label>
      <input
        type="text"
        pInputText
        class="w-full font-bold"
        formControlName="warrantyService"
        [class]="
          supportForm.get('warrantyService')?.value ===
          'GARANTÍA DE SERVICIO TÉCNICO VENCIDA'
            ? 'bg-red-100 text-red-600'
            : supportForm.get('warrantyService')?.value === 'N/A'
            ? 'bg-gray-100 text-gray-600'
            : supportForm.get('warrantyService')?.value
            ? 'bg-green-100 text-green-600'
            : 'bg-gray-100 text-gray-600'
        "
      />
    </div>
  </div>
  <div class="w-full flex gap-2">
    <div class="w-full">
      <label>GARANTIA</label>
      <p-dropdown
        [options]="booleanDropdown"
        optionLabel="label"
        optionValue="value"
        placeholder="Seleccionar..."
        styleClass="w-full"
        formControlName="warranty"
      ></p-dropdown>
    </div>
    <div class="w-full">
      <label>TIPO DE PRIORIDAD</label>
      <p-dropdown
        [options]="supportPrioritiesDropdown"
        optionLabel="name"
        optionValue="id"
        placeholder="Seleccionar..."
        styleClass="w-full"
        formControlName="priority"
        [ngClass]="{ 'ng-invalid ng-dirty': validateForm('priority') }"
      />
      <small *ngIf="validateForm('priority')" class="p-error">
        Campo requerido*
      </small>
    </div>
  </div>

  <div class="w-full flex gap-2">
    <div class="w-full">
      <label>REMITO DE PRODUCTO ENTRANTE</label>
      <input
        type="text"
        pInputText
        class="w-full"
        formControlName="reference"
      />
    </div>
    <div class="w-full">
      <label>FAJA DE SEGURIDAD</label>
      <p-dropdown
        [options]="booleanDropdown"
        optionLabel="label"
        optionValue="value"
        placeholder="Seleccionar..."
        styleClass="w-full"
        formControlName="securityStrap"
      ></p-dropdown>
    </div>
  </div>

  <div class="w-full">
    <label>FALLA REPORTADA</label>
    <input type="text" pInputText class="w-full" formControlName="failure" />
  </div>

  <div class="w-full">
    <label>TIPO DE FALLA</label>
    <p-dropdown
      [options]="failureTypesDropdown"
      optionLabel="name"
      optionValue="id"
      [filter]="true"
      placeholder="Seleccionar..."
      styleClass="w-full"
      formControlName="failureType"
    >
    </p-dropdown>
  </div>

  <div class="w-full">
    <label>OBSERVACIONES</label>
    <textarea
      pInputTextarea
      maxlength="250"
      class="w-full"
      [autoResize]="true"
      rows="6"
      formControlName="remarks"
    ></textarea>
  </div>

  <div class="flex justify-content-between w-full">
    <div>
      <p-button
        *ngIf="showButtonClean"
        label="LIMPIAR FORMULARIO"
        styleClass="p-button-secondary p-button-text"
        (onClick)="cleanForm()"
      />
      <p-button
        *ngIf="showButtonState"
        label="CANCELAR SERVICIO"
        styleClass="p-button-danger p-button-text"
        (onClick)="cancelForm()"
      />
      <p-button
        *ngIf="showButtonState"
        label="ACTUALIZAR ESTADO DEL SERVICIO"
        styleClass="p-button-success p-button-text"
        (onClick)="openHistoryForm()"
      />
    </div>
    <div class="flex gap-2">
      <p-button
        label="SALIR DEL FORMULARIO"
        styleClass="p-button-secondary p-button-text"
        (onClick)="exitForm()"
      />
      <p-button
        [label]="mainButtonLabel"
        [disabled]="supportForm.invalid"
        styleClass="p-button-info p-button-text"
        (onClick)="submitForm()"
      />
    </div>
  </div>
</form>
